@model BookComment

<link rel="stylesheet" href="~/wwwroot/css/styles.css">

@{
    ViewData["Title"] = "Description";

    var hasAccess = User.Claims.Any(c => c.Type == ClaimTypes.Role && c.Value == "Admin");


    var bookName = Model.book.Name;

    var comment = new Comment();
}

@* <h2>Results for @bookName</h2>
<div>
<p>Name: @(Model?.book.Name ?? "UNKNOWN")</p>
<p>Author: @(Model?.book.Author ?? "UNKNOWN")</p>
<p>Year: @(Model?.book.PublicationYear.ToString() ?? "UNKNOWN")</p>
<p>Genre: @(Model?.book.Genre ?? "UNKNOWN")</p>
<p>Language: @(Model?.book.Language ?? "UNKNOWN")</p>
<p>Description: @(Model?.book.Description ?? "UNKNOWN")</p>
<hr>
@foreach (var item in Model.comments)
{
<div class="media mb-4">
<div class="media-body">
<h5 class="mt-0">@item.SenderId</h5>
<p>@item.Text</p>
</div>
</div>
}


</div> *@

<div class="container mt-5">
    <h2>Results for @bookName</h2>

    <div class="card">
        <div class="card-body">
            <p class="card-text"><strong>Name:</strong> @(Model?.book.Name ?? "UNKNOWN")</p>
            <p class="card-text"><strong>Author:</strong> @(Model?.book.Author ?? "UNKNOWN")</p>
            <p class="card-text"><strong>Year:</strong> @(Model?.book.PublicationYear?.ToString() ?? "UNKNOWN")</p>
            <p class="card-text"><strong>Genre:</strong> @(Model?.book.Genre ?? "UNKNOWN")</p>
            <p class="card-text"><strong>Language:</strong> @(Model?.book.Language ?? "UNKNOWN")</p>
            <p class="card-text"><strong>Description:</strong> @(Model?.book.Description ?? "UNKNOWN")</p>
        </div>
        @using (Html.BeginForm("BuyBook", "Identity", FormMethod.Post)){
            <input type="submit" value="Buy" />
        }
        @using (Html.BeginForm("AddtoWishlistBook", "Identity", FormMethod.Post)){
            <input type="submit" value="Add to wishlist" />
        }
    </div>

    <hr>

    <div class="card">
        <div class="card-body">
            <h5 class="card-title">Comments</h5>

            @foreach (var item in Model.comments)
            {
                <div class="media mb-3">
                    <img src="https://via.placeholder.com/64" class="mr-3 rounded-circle" alt="User Avatar"
                        style="width: 64px;">
                    <div class="media-body">
                        <h6 class="mt-0">@item.SenderName @item.SenderSurname</h6>
                        <p>@item.Text</p>
                    </div>
                </div>
            }

            <form asp-controller="Comment" asp-action="Add">
                <div class="form-group">
                    <label asp-for="@comment.Text" class="control-label"></label>
                    <input asp-for="@comment.Text" class="form-control" id="commentInput" />
                    <span asp-validation-for="@comment.Text" class="text-danger"></span>
                </div>
                <div class="form-group">
                    @* @if (base.User.Identity.IsAuthenticated)
                    {
                    <input type="submit" value="Add" class="btn btn-primary addButton" id="addButton" />
                    }
                    else
                    {
                    <input type="submit" value="Add" class="btn btn-primary addButton" disabled />
                    } *@
                    <button class="btn btn-primary" id="addButton" >Add</button>
                    <script>
                        const commentInput = document.querySelector("#commentInput");
                        const button = document.querySelector("#addButton");

                        commentInput.addEventListener("commentInput", validate);

                        function validate() {
                            if (commentInput.value === "") {
                                button.setAttribute("disabled", "disabled");
                            }
                            else {
                                button.removeAttribute("disabled");
                            }
                        }    
                    </script>
                </div>
            </form>
        </div>
    </div>
</div>